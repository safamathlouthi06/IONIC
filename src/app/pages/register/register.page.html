<ion-header [translucent]="true">
  <ion-toolbar color="primary" class="register-toolbar">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/login" text="Retour" class="back-button"></ion-back-button>
    </ion-buttons>
    <ion-title>Inscription</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="register-content">
  <div class="register-container">
    <!-- En-tête visuel -->
    <div class="header-section">
      <div class="icon-container">
        <span class="header-emoji">🎉</span>
      </div>
      <div class="header-text">
        <h1 class="header-title">Commencez l'aventure !</h1>
        <p class="header-subtitle">Créez votre compte en moins d'une minute</p>
      </div>
    </div>

    <!-- Formulaire d'inscription -->
    <form [formGroup]="registerForm" (ngSubmit)="register()" class="register-form">
      <!-- Champ Email -->
      <div class="input-group">
        <div class="input-container">
          <div class="input-icon">📧</div>
          <div class="input-field">
            <label class="input-label">
              Adresse email
              <span class="required">*</span>
            </label>
            <input 
              type="email" 
              formControlName="email"
              placeholder="exemple@email.com"
              class="custom-input">
          </div>
        </div>
        @if (registerForm.get('email')?.invalid && registerForm.get('email')?.touched) {
          <div class="error-message">
            @if (registerForm.get('email')?.errors?.['required']) {
              L'email est requis
            } @else if (registerForm.get('email')?.errors?.['email']) {
              Format d'email invalide
            }
          </div>
        }
      </div>

      <!-- Champ Mot de passe -->
      <div class="input-group">
        <div class="input-container">
          <div class="input-icon">🔒</div>
          <div class="input-field">
            <label class="input-label">
              Mot de passe
              <span class="required">*</span>
            </label>
            <input 
              type="password" 
              formControlName="password"
              placeholder="Minimum 8 caractères"
              class="custom-input">
          </div>
        </div>
        @if (registerForm.get('password')?.invalid && registerForm.get('password')?.touched) {
          <div class="error-message">
            @if (registerForm.get('password')?.errors?.['required']) {
              Le mot de passe est requis
            } @else if (registerForm.get('password')?.errors?.['minlength']) {
              Minimum 8 caractères requis
            }
          </div>
        }
      </div>

      <!-- Sélecteur de rôle -->
      <div class="input-group">
        <label class="input-label">
          Type de compte
          <span class="required">*</span>
        </label>
        <div class="role-selector">
          <div 
            class="role-option" 
            [class.selected]="registerForm.get('role')?.value === 'client'"
            (click)="registerForm.get('role')?.setValue('client')">
            <div class="role-icon">👤</div>
            <div class="role-content">
              <div class="role-title">Client</div>
              <div class="role-description">Acheter des produits</div>
            </div>
            <div class="role-checkbox">
              <div class="checkbox" [class.checked]="registerForm.get('role')?.value === 'client'">✓</div>
            </div>
          </div>
          
          <div 
            class="role-option" 
            [class.selected]="registerForm.get('role')?.value === 'merchant'"
            (click)="registerForm.get('role')?.setValue('merchant')">
            <div class="role-icon">🏪</div>
            <div class="role-content">
              <div class="role-title">Commerçant</div>
              <div class="role-description">Vendre vos produits</div>
            </div>
            <div class="role-checkbox">
              <div class="checkbox" [class.checked]="registerForm.get('role')?.value === 'merchant'">✓</div>
            </div>
          </div>
        </div>
        @if (registerForm.get('role')?.invalid && registerForm.get('role')?.touched) {
          <div class="error-message">
            Veuillez sélectionner un type de compte
          </div>
        }
      </div>

      <!-- Conditions d'utilisation -->
      <div class="terms-group">
        <label class="terms-container">
          <input 
            type="checkbox" 
            formControlName="terms"
            class="terms-checkbox">
          <span class="checkmark"></span>
          <span class="terms-label">
            J'accepte les 
            <a href="#" class="link">conditions d'utilisation</a> 
            et la 
            <a href="#" class="link">politique de confidentialité</a>
            <span class="required">*</span>
          </span>
        </label>
        @if (registerForm.get('terms')?.invalid && registerForm.get('terms')?.touched) {
          <div class="error-message">
            Vous devez accepter les conditions
          </div>
        }
      </div>

      <!-- Bouton d'inscription -->
      <button 
        type="submit" 
        class="register-button"
        [class.loading]="isLoading"
        [disabled]="!registerForm.valid || isLoading">
        @if (isLoading) {
          <div class="button-loading">
            <span class="loading-spinner"></span>
            Création du compte...
          </div>
        } @else {
          <span>🚀 Créer mon compte</span>
        }
      </button>
    </form>

    <!-- Séparateur -->
    <div class="separator">
      <span class="separator-line"></span>
      <span class="separator-text">Ou s'inscrire avec</span>
      <span class="separator-line"></span>
    </div>

    <!-- Connexion sociale -->
    <div class="social-register">
      <button class="social-button google-button">
        <span class="social-icon">🔍</span>
        <span class="social-text">Google</span>
      </button>
      
      <button class="social-button facebook-button">
        <span class="social-icon">👥</span>
        <span class="social-text">Facebook</span>
      </button>
    </div>

    <!-- Lien de connexion -->
    <div class="login-section">
      <p class="login-text">
        Déjà inscrit ? 
        <a routerLink="/login" class="login-link">🔐 Se connecter</a>
      </p>
    </div>

    <!-- Message d'erreur -->
    @if (errorMessage) {
      <div class="error-banner">
        <span class="error-icon">⚠️</span>
        <span class="error-text">{{ errorMessage }}</span>
      </div>
    }
  </div>
</ion-content>